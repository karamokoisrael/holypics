import{defineComponent as t,ref as e,inject as r,computed as n,resolveComponent as a,openBlock as o,createElementBlock as i,createBlock as l,withCtx as s,resolveDynamicComponent as d,createVNode as c,normalizeClass as u,createCommentVNode as h,createTextVNode as f,toDisplayString as v,createElementVNode as p}from"vue";import{useI18n as m}from"vue-i18n";var g=(0).constructor,y=g.isFinite;g.isInteger;var b=[].constructor.isArray;function w(t){return null!==t&&"object"==typeof t}function x(t,e){return void 0===e&&(e=0),"string"==typeof t&&t.length>=e}function E(t){return y(t)}function k(t){return b(t)}function _(t,e){return w(t)&&e in t}var A=new(function(){function t(t){this.size=t,this.reset()}return t.prototype.reset=function(){this.oldestIndex=0,this.map={},this.cachedKeys=new Array(this.size)},t.prototype.get=function(t){return this.map[t]},t.prototype.set=function(t,e){this.map[t]=e;var r=this.cachedKeys[this.oldestIndex];void 0!==r&&delete this.map[r],this.cachedKeys[this.oldestIndex]=t,this.oldestIndex++,this.oldestIndex%=this.size},t}())(1e3);function S(t){var e=t.charAt(0),r=t.substr(-1);if("'\"`".includes(e)||"'\"`".includes(r)){if(t.length<2||e!==r)throw new SyntaxError('Mismatching string quotation: "'+t+'"');return t.substring(1,t.length-1)}if(t.includes("["))throw new SyntaxError('Missing ] in varName "'+t+'"');return"+"===e?t.substr(1):t}function T(t,e,r){var n=e.trim();if(""===n)return t;if(n.startsWith(".")){if(!r)throw new SyntaxError('Unexpected . at the start of "'+e+'"');if(""===(n=n.substr(1).trim()))return t}else if(r)throw new SyntaxError('Missing . at the start of "'+e+'"');if(n.endsWith("."))throw new SyntaxError('Unexpected "." at the end of "'+e+'"');for(var a=0,o=n.split(".");a<o.length;a++){var i=o[a].trim();if(""===i)throw new SyntaxError('Empty prop name when parsing "'+e+'"');t.push(i)}return t}function N(t){if(!x(t))throw new TypeError("Cannot parse path. Expected string. Got a "+typeof t);for(var e,r,n=0,a=!1,o=new Array(0),i=0;i<t.length&&-1!==(e=t.indexOf("[",i));i=n){if(-1===(n=t.indexOf("]",e)))throw new SyntaxError('Missing ] in varName "'+t+'"');if(0===(r=t.substring(e+1,n).trim()).length)throw new SyntaxError("Unexpected token ]");n++,T(o,t.substring(i,e),a),o.push(S(r)),a=!0}return T(o,t.substring(n),a)}function I(t,e,r){if(void 0===r&&(r={}),!w(r))throw new TypeError("get expects an object option. Got "+typeof r);var n=r.depth,a=void 0===n?10:n;if(!E(a)||a<=0)throw new RangeError("Expected a positive number for depth. Got "+a);var o=Array.isArray(e)?e:N.cached(e),i=function(){return o.join(" > ")};if(o.length>a)throw new ReferenceError("The path cannot be deeper than "+a+' levels. Got "'+i()+'"');for(var l=t,s=0,d=o;s<d.length;s++){var c=d[s];if(!_(l,c)){if(r.propsExist)throw new ReferenceError(c+' is not defined in the scope at path: "'+i()+'"');return}l=l[c]}return l}N.cached=function(t){var e=A.get(t);return void 0===e&&(e=N(t),A.set(t,e)),e};var C=function(){function t(t,e){var r=this;if(void 0===e&&(e={}),this.tokens=t,this.options=e,this.render=function(t){void 0===t&&(t={});var e=r.tokens.varNames.length;r.cacheParsedPaths();for(var n=new Array(e),a=0;a<e;a++)n[a]=I(t,r.toPathCache[a],r.options);return r.stringify(n)},this.renderFn=function(t,e){void 0===e&&(e={});var n=r.resolveVarNames(t,e);return r.stringify(n)},this.renderFnAsync=function(t,e){return void 0===e&&(e={}),Promise.all(r.resolveVarNames(t,e)).then((function(t){return r.stringify(t)}))},!w(t)||!k(t.strings)||!k(t.varNames)||t.strings.length!==t.varNames.length+1)throw new TypeError("Invalid tokens object");if(!w(e))throw new TypeError("Options should be an object. Got a "+typeof e);e.validateVarNames&&this.cacheParsedPaths()}return t.prototype.cacheParsedPaths=function(){var t=this.tokens.varNames;if(void 0===this.toPathCache){this.toPathCache=new Array(t.length);for(var e=0;e<t.length;e++)this.toPathCache[e]=N.cached(t[e])}},t.prototype.resolveVarNames=function(t,e){void 0===e&&(e={});var r=this.tokens.varNames;if("function"!=typeof t)throw new TypeError("Expected a resolver function. Got "+String(t));for(var n=r.length,a=new Array(n),o=0;o<n;o++)a[o]=t.call(null,r[o],e);return a},t.prototype.stringify=function(t){for(var e=this.tokens.strings,r=this.options.explicit,n=t.length,a="",o=0;o<n;o++){a+=e[o];var i=t[o];(r||null!=i)&&(a+=i)}return a+=e[n]},t}();function $(t,e){void 0===e&&(e={});var r=function(t,e){if(void 0===e&&(e={}),!x(t))throw new TypeError("The template parameter must be a string. Got a "+typeof t);if(!w(e))throw new TypeError("Options should be an object. Got a "+typeof e);var r=e.tags,n=void 0===r?["{{","}}"]:r,a=e.maxVarNameLength,o=void 0===a?1e3:a;if(!k(n)||2!==n.length)throw TypeError("tags should be an array of two elements. Got "+String(n));var i=n[0],l=n[1];if(!x(i,1)||!x(l,1)||i===l)throw new TypeError('The open and close symbols should be two distinct non-empty strings. Got "'+i+'" and "'+l+'"');if(!E(o)||o<=0)throw new Error("Expected a positive number for maxVarNameLength. Got "+o);for(var s,d,c=i.length,u=l.length,h=0,f=[],v=[],p=0;p<t.length&&-1!==(s=t.indexOf(i,p));){var m=s+c;if(-1===(h=t.substr(m,o+u).indexOf(l)))throw new SyntaxError('Missing "'+l+'" in the template for the "'+i+'" at position '+s+" within "+o+" characters");if(h+=m,0===(d=t.substring(m,h).trim()).length)throw new SyntaxError('Unexpected "'+l+'" tag found at position '+s);if(d.includes(i))throw new SyntaxError('Variable names cannot have "'+i+'". But at position '+s+'. Got "'+d+'"');v.push(d),h+=u,f.push(t.substring(p,s)),p=h}return f.push(t.substring(h)),{strings:f,varNames:v}}(t,e);return new C(r,e)}function V(t,e,r){return $(t,r).render(e)}var G=t({name:"InterfaceGroupDetail",props:{field:{type:Object,required:!0},fields:{type:Array,required:!0},values:{type:Object,required:!0},initialValues:{type:Object,required:!0},disabled:{type:Boolean,default:!1},batchMode:{type:Boolean,default:!1},batchActiveFields:{type:Array,default:()=>[]},primaryKey:{type:[Number,String],required:!0},loading:{type:Boolean,default:!1},validationErrors:{type:Array,default:()=>[]},layout:{type:String,default:"modal"},title:{type:String,default:null},url:{type:String,default:"/ssr"},headerIcon:{type:String,default:null},headerColor:{type:String,default:"secondary"}},emits:["apply"],setup(t){const{t:a}=m(),o=e(!1),i=r("values",e({}));return{t:a,groupTitle:n((()=>t.title?V(t.title,i.value):t.field.name)),internalActive:o,src:n((()=>V(t.url,i.value))),layout:t.layout}}});const j={class:"group-modal"},O=["src"],P=["src"];var q=[],M=[];!function(t,e){if(t&&"undefined"!=typeof document){var r,n=!0===e.prepend?"prepend":"append",a=!0===e.singleTag,o="string"==typeof e.container?document.querySelector(e.container):document.getElementsByTagName("head")[0];if(a){var i=q.indexOf(o);-1===i&&(i=q.push(o)-1,M[i]={}),r=M[i]&&M[i][n]?M[i][n]:M[i][n]=l()}else r=l();65279===t.charCodeAt(0)&&(t=t.substring(1)),r.styleSheet?r.styleSheet.cssText+=t:r.appendChild(document.createTextNode(t))}function l(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),e.attributes)for(var r=Object.keys(e.attributes),a=0;a<r.length;a++)t.setAttribute(r[a],e.attributes[r[a]]);var i="prepend"===n?"afterbegin":"beforeend";return o.insertAdjacentElement(i,t),t}}("\n.modal-iframe[data-v-64969d30]{\n\twidth: 100vw !important;\n\theight: 65vh !important;\n\toverflow-y: auto !important;\n\tborder: unset !important;\n}\n.modal-ssr-container[data-v-64969d30]{\n\tdisplay: flex;\n\talign-content: center;\n\tjustify-content: center;\n\twidth: 100% !important;\n\theight: 100% !important;\n}\n.sidebar-iframe[data-v-64969d30]{\n\twidth: 100vw !important;\n\theight: 100vh !important;\n\toverflow-y: auto !important;\n\tborder: unset !important;\n}\n.sidebar-ssr-container[data-v-64969d30]{\n\tdisplay: flex;\n\talign-content: center;\n\tjustify-content: center;\n\twidth: 100% !important;\n\theight: 100% !important;\n}\n.trigger-button.info[data-v-64969d30] {\n\t--v-button-background-color: var(--blue);\n\t--v-button-background-color-hover: var(--blue-125);\n\t--v-button-color: var(--blue-alt);\n\t--v-button-color-hover: var(--blue-alt);\n}\n.trigger-button.success[data-v-64969d30] {\n\t--v-button-background-color: var(--success);\n\t--v-button-background-color-hover: var(--success-125);\n\t--v-button-color: var(--success-alt);\n\t--v-button-color-hover: var(--success-alt);\n}\n.trigger-button.warning[data-v-64969d30] {\n\t--v-button-background-color: var(--warning);\n\t--v-button-background-color-hover: var(--warning-125);\n\t--v-button-color: var(--warning-alt);\n\t--v-button-color-hover: var(--warning-alt);\n}\n.trigger-button.danger[data-v-64969d30] {\n\t--v-button-icon-color: var(--white);\n\t--v-button-background-color: var(--danger);\n\t--v-button-background-color-hover: var(--danger-125);\n\t--v-button-color: var(--danger-alt);\n\t--v-button-color-hover: var(--danger-alt);\n}\n.v-form[data-v-64969d30] {\n\tpadding-top: calc(var(--form-vertical-gap) / 2);\n}\n.v-form.in-drawer[data-v-64969d30] {\n\tpadding-left: var(--form-horizontal-gap);\n}\n@media (max-width: 959px) {\n.v-form.in-drawer[data-v-64969d30] {\n\t\tpadding-right: var(--form-horizontal-gap);\n}\n}\n",{}),G.render=function(t,e,r,n,m,g){const y=a("v-icon"),b=a("v-button"),w=a("v-card-title"),x=a("v-card-text"),E=a("v-card-actions"),k=a("v-card"),_=a("v-dialog"),A=a("v-drawer");return o(),i("div",j,["modal"===t.layout?(o(),l(_,{key:0,modelValue:t.internalActive,"onUpdate:modelValue":e[1]||(e[1]=e=>t.internalActive=e),onEsc:e[2]||(e[2]=e=>t.internalActive=!1),persistent:!0,placement:"center"},{activator:s((({on:e})=>[(o(),l(d(t.validationErrors.length>0?"v-badge":"div"),{icon:"priority_high",bordered:""},{default:s((()=>[c(b,{small:"",class:u(["trigger-button",t.headerColor]),onClick:e},{default:s((()=>[t.headerIcon?(o(),l(y,{key:0,name:t.headerIcon,left:"",disabled:t.disabled},null,8,["name","disabled"])):h("v-if",!0),f(" "+v(t.groupTitle),1)])),_:2},1032,["class","onClick"])])),_:2},1024))])),default:s((()=>[c(k,null,{default:s((()=>[c(w,null,{default:s((()=>[t.headerIcon?(o(),l(y,{key:0,name:t.headerIcon,left:"",disabled:t.disabled},null,8,["name","disabled"])):h("v-if",!0),f(" "+v(t.groupTitle),1)])),_:1}),c(x,null,{default:s((()=>[h(' <v-form\n\t\t\t\t\t\t:initial-values="initialValues"\n\t\t\t\t\t\t:fields="fields"\n\t\t\t\t\t\t:model-value="values"\n\t\t\t\t\t\t:primary-key="primaryKey"\n\t\t\t\t\t\t:group="field.meta.field"\n\t\t\t\t\t\t:validation-errors="validationErrors"\n\t\t\t\t\t\t:loading="loading"\n\t\t\t\t\t\t:batch-mode="batchMode"\n\t\t\t\t\t\t@update:model-value="$emit(\'apply\', $event)"\n\t\t\t\t\t/> '),p("div",{class:u("modal"==t.layout?"modal-ssr-container":"sidebar-ssr-container")},[p("iframe",{class:u("modal"==t.layout?"modal-iframe":"sidebar-iframe"),src:t.src},null,10,O)],2)])),_:1}),c(E,null,{default:s((()=>[c(b,{onClick:e[0]||(e[0]=e=>t.internalActive=!1)},{default:s((()=>[f(v(t.t("done")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])):(o(),l(A,{key:1,modelValue:t.internalActive,"onUpdate:modelValue":e[3]||(e[3]=e=>t.internalActive=e),persistent:!0,title:t.groupTitle,icon:t.headerIcon||"box",onCancel:e[4]||(e[4]=e=>t.internalActive=!1)},{activator:s((({on:e})=>[(o(),l(d(t.validationErrors.length>0?"v-badge":"div"),{icon:"priority_high",bordered:""},{default:s((()=>[c(b,{small:"",class:u(["trigger-button",t.headerColor]),onClick:e},{default:s((()=>[t.headerIcon?(o(),l(y,{key:0,name:t.headerIcon,left:"",disabled:t.disabled},null,8,["name","disabled"])):h("v-if",!0),f(" "+v(t.groupTitle),1)])),_:2},1032,["class","onClick"])])),_:2},1024))])),default:s((()=>[p("div",{class:u("modal"==t.layout?"modal-ssr-container":"sidebar-ssr-container")},[p("iframe",{class:u("modal"==t.layout?"modal-iframe":"sidebar-iframe"),src:t.src},null,10,P)],2)])),_:1},8,["modelValue","title","icon"]))])},G.__scopeId="data-v-64969d30",G.__file="src/interface.vue";var U={id:"extension-ssr-group-modal",name:"modal ssr",description:"Group fields into modal dialog, accessible from a button",icon:"web_asset",component:G,hideLabel:!0,hideLoader:!0,types:["alias"],localTypes:["group"],group:"group",options:t=>[{field:"layout",name:"$t:layout_setup",type:"string",meta:{width:"half",interface:"select-dropdown",default_value:"modal",options:{choices:[{text:"$t:interfaces.user.modes.modal",value:"modal"},{text:"$t:sidebar",value:"sidebar"}]}},schema:{default_value:"modal"}},{field:"title",type:"string",name:"$t:title",meta:{width:"full",interface:"system-display-template",required:!0,options:{collectionName:t.collection,font:"monospace",placeholder:"$t:interfaces.boolean.label_placeholder"}}},{field:"url",type:"url",name:"url",meta:{width:"full",interface:"system-display-template",required:!0,options:{collectionName:t.collection,font:"monospace",placeholder:"$t:interfaces.boolean.label_placeholder"}}},{field:"headerIcon",name:"$t:interfaces.group-detail.header_icon",type:"string",meta:{interface:"select-icon",width:"half"}},{field:"headerColor",name:"$t:interfaces.group-detail.header_color",type:"string",meta:{width:"half",interface:"select-dropdown",default_value:"",options:{choices:[{text:"$t:primary",value:"primary"},{text:"$t:normal",value:"secondary"},{text:"$t:info",value:"info"},{text:"$t:success",value:"success"},{text:"$t:warning",value:"warning"},{text:"$t:danger",value:"danger"}]}},schema:{default_value:""}}]};export{U as default};
