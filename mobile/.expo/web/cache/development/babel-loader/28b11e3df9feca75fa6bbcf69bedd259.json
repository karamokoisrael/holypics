{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useRef } from \"react\";\nimport { Stack, Heading, useMediaQuery, useToast } from \"native-base\";\nimport Layout from \"../../components/layout/Layout\";\nimport Carousel from \"react-native-reanimated-carousel\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport MainCarouselItem, { MainCarouselItemSkeleton } from \"../../components/custom/MainCarouselItem\";\nimport useSWR from \"swr\";\nimport { formatUrl, getImageUrl, getLogoUrl } from \"../../helpers/utils\";\nimport useStore from \"../../context/store\";\nimport { maxSmallScreenWidth } from \"../../constants/layout\";\nimport SearchBar from \"../../components/custom/SearchBar\";\nimport ProductCard, { ProductCardSkeleton } from \"../../components/custom/ProductCard\";\nimport CategoryCard, { CategoryCardSkeleton } from \"../../components/custom/CategoryCard\";\nimport IconCard from \"../../components/custom/IconCard\";\nimport { ConditionalSuspense } from \"../../components/layout/ConditionalSuspense\";\nimport { MapList } from \"../../components/layout/MapList\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function Home(_ref) {\n  var _screenData$data;\n\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var toast = useToast();\n  var categories = useStore(function (state) {\n    return state.configs.categories;\n  });\n\n  var renderGalleryUrl = function renderGalleryUrl(itemId, currentGallery) {\n    return currentGallery.length - 1 > itemId ? getImageUrl(\"\" + currentGallery[itemId].image) : getLogoUrl();\n  };\n\n  var screenData = useSWR(formatUrl(\"items/gallery?limit=-1&filter[status]=published&sort=-date_created\"), function _callee() {\n    var res,\n        resJson,\n        gottenServices,\n        gottenSlides,\n        gottenBrands,\n        _args = arguments;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch.apply(void 0, _args));\n\n          case 2:\n            res = _context.sent;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 5:\n            resJson = _context.sent;\n\n            if (!(resJson.errors != undefined)) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", toast.show({\n              title: resJson.errors[0].message\n            }));\n\n          case 8:\n            gottenServices = resJson.data.filter(function (galleryItem) {\n              return galleryItem.group == \"service\";\n            });\n            gottenSlides = resJson.data.filter(function (galleryItem) {\n              return galleryItem.group == \"slider\";\n            });\n            gottenBrands = resJson.data.filter(function (galleryItem) {\n              return galleryItem.group == \"brand\";\n            });\n            return _context.abrupt(\"return\", {\n              services: gottenServices,\n              slides: gottenSlides,\n              brands: gottenBrands\n            });\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }, {\n    revalidateOnFocus: false,\n    shouldRetryOnError: true\n  });\n  var nowToSeeProducts = useSWR(formatUrl(\"items/products?limit=20&filter[status]=published&sort=-date_created\"), function _callee2() {\n    var res,\n        resJson,\n        _args2 = arguments;\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(fetch.apply(void 0, _args2));\n\n          case 2:\n            res = _context2.sent;\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 5:\n            resJson = _context2.sent;\n\n            if (!(resJson.errors != undefined)) {\n              _context2.next = 9;\n              break;\n            }\n\n            toast.show({\n              title: resJson.errors[0].message\n            });\n            throw new Error(resJson.errors);\n\n          case 9:\n            return _context2.abrupt(\"return\", resJson.data);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }, {\n    revalidateOnFocus: false,\n    shouldRetryOnError: true\n  });\n  var categoriesProducts = useSWR(formatUrl(\"items/products?limit=10&filter[status]=published&sort=-date_created\"), function _callee3() {\n    var data,\n        _iterator,\n        _step,\n        category,\n        res,\n        resJson,\n        _args3 = arguments;\n\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            data = [];\n            _iterator = _createForOfIteratorHelperLoose(categories);\n\n          case 2:\n            if ((_step = _iterator()).done) {\n              _context3.next = 15;\n              break;\n            }\n\n            category = _step.value;\n            _context3.next = 6;\n            return _regeneratorRuntime.awrap(fetch((_args3.length <= 0 ? undefined : _args3[0]) + \"&filter[category]=\" + category));\n\n          case 6:\n            res = _context3.sent;\n            _context3.next = 9;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 9:\n            resJson = _context3.sent;\n\n            if (!(resJson.errors != undefined)) {\n              _context3.next = 12;\n              break;\n            }\n\n            throw new Error(resJson.errors);\n\n          case 12:\n            if (resJson.data.length != 0) {\n              data.push({\n                id: category.id,\n                name: category.name,\n                products: resJson.data\n              });\n            }\n\n          case 13:\n            _context3.next = 2;\n            break;\n\n          case 15:\n            return _context3.abrupt(\"return\", data);\n\n          case 16:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }, {\n    revalidateOnFocus: false,\n    shouldRetryOnError: true\n  });\n\n  var _useMediaQuery = useMediaQuery({\n    maxWidth: maxSmallScreenWidth\n  }),\n      _useMediaQuery2 = _slicedToArray(_useMediaQuery, 1),\n      isSmallScreen = _useMediaQuery2[0];\n\n  var menus = [{\n    text: \"Soldes\",\n    route: \"Home\",\n    icon: \"52a7196b-eea7-4e0f-9aa6-99eee1145ce5\"\n  }, {\n    text: \"Boutiques\",\n    route: \"Home\",\n    icon: \"fa4014a2-9e42-49d2-b6d6-8aa102ea7beb\"\n  }, {\n    text: \"Made in CI\",\n    route: \"Home\",\n    icon: \"ec3ce20b-1145-4e6d-b98c-ae0a897c5785\"\n  }, {\n    text: \"Recommandés\",\n    route: \"Home\",\n    icon: \"f2c80949-cae7-4295-a10e-486273147030?\"\n  }];\n  var screenWidth = Dimensions.get(\"window\").width > 1184 ? 1184 : Dimensions.get(\"window\").width;\n  var mainCarouselRef = useRef({\n    prev: function prev() {},\n    next: function next() {}\n  });\n  return _jsx(Layout, {\n    navigation: navigation,\n    route: route,\n    children: _jsxs(_Fragment, {\n      children: [_jsx(ConditionalSuspense, {\n        condition: isSmallScreen,\n        children: _jsx(SearchBar, {\n          navigation: navigation,\n          route: route\n        })\n      }), _jsx(ConditionalSuspense, {\n        condition: screenData.data != undefined,\n        fallBack: _jsx(MainCarouselItemSkeleton, {}),\n        children: _jsx(Carousel, {\n          width: screenWidth,\n          height: isSmallScreen ? 300 : 500,\n          data: (_screenData$data = screenData.data) == null ? void 0 : _screenData$data.slides,\n          autoPlay: true,\n          autoPlayInterval: 3000,\n          renderItem: function renderItem(_ref2) {\n            var _screenData$data2;\n\n            var item = _ref2.item;\n            var slideId = (_screenData$data2 = screenData.data) == null ? void 0 : _screenData$data2.slides.findIndex(function (currentItem) {\n              return item.id == currentItem.id;\n            });\n            return _jsx(MainCarouselItem, {\n              onPressPrev: typeof mainCarouselRef.current.prev == \"function\" ? mainCarouselRef.current.prev : function () {},\n              onPressNext: typeof mainCarouselRef.current.next == \"function\" ? mainCarouselRef.current.next : function () {},\n              id: slideId,\n              totalItem: screenData.data.slides.length,\n              heading: item.name,\n              imageUri: renderGalleryUrl(slideId, screenData.data.slides),\n              content: item.description,\n              btnText: \"VOIR PLUS\",\n              paddingBottom: 2,\n              width: \"100%\",\n              height: isSmallScreen ? 300 : 500,\n              imageBackgroundStyle: !isSmallScreen ? {} : {\n                height: 300\n              },\n              containerStyle: !isSmallScreen ? {} : {\n                height: 300\n              },\n              btnAction: function btnAction() {}\n            });\n          }\n        })\n      }), _jsx(Stack, {\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-around\",\n        flexDirection: \"row\",\n        paddingTop: 2,\n        width: \"100%\",\n        children: _jsx(MapList, {\n          data: menus,\n          render: function render(menu) {\n            return _jsx(IconCard, {\n              onPress: function onPress() {\n                return alert(menu.text);\n              },\n              text: menu.text,\n              image: {\n                uri: getImageUrl(menu.icon)\n              }\n            }, menu.text);\n          }\n        })\n      }), _jsxs(Stack, {\n        display: \"flex\",\n        alignItems: \"center\",\n        children: [_jsx(Heading, {\n          margin: 5,\n          children: \" S\\xC9LECTION RAPIDE\"\n        }), _jsx(Stack, {\n          alignItems: \"center\",\n          justifyContent: \"flex-start\",\n          direction: \"row\",\n          flexWrap: \"wrap\",\n          children: _jsx(ConditionalSuspense, {\n            condition: categories.length != 0,\n            fallBack: _jsx(MapList, {\n              data: _toConsumableArray(Array(8).keys()),\n              render: function render(key) {\n                return _jsx(CategoryCardSkeleton, {}, key);\n              }\n            }),\n            children: _jsx(MapList, {\n              data: categories,\n              render: function render(item) {\n                return _jsx(CategoryCard, {\n                  category: item,\n                  navigation: navigation\n                }, item.id);\n              }\n            })\n          })\n        })]\n      }), _jsxs(Stack, {\n        flex: 1,\n        alignItems: \"center\",\n        width: \"100%\",\n        height: 'auto',\n        children: [_jsx(Heading, {\n          margin: 5,\n          children: \" ACH\\xC8TE D\\xC8S MAINTENANT\"\n        }), _jsx(Stack, {\n          alignItems: \"center\",\n          justifyContent: \"flex-start\",\n          direction: \"row\",\n          flexWrap: \"wrap\",\n          width: \"100%\",\n          children: _jsx(ConditionalSuspense, {\n            condition: nowToSeeProducts.data != undefined,\n            fallBack: _jsx(MapList, {\n              data: _toConsumableArray(Array(8).keys()),\n              render: function render(key) {\n                return _jsx(ProductCardSkeleton, {}, key);\n              }\n            }),\n            children: _jsx(MapList, {\n              data: nowToSeeProducts.data,\n              render: function render(item) {\n                return _jsx(ProductCard, {\n                  product: item\n                }, item.id);\n              }\n            })\n          })\n        })]\n      }), _jsx(Stack, {\n        flex: 1,\n        alignItems: \"center\",\n        width: \"100%\",\n        height: 'auto',\n        backgroundColor: \"#000\",\n        children: _jsx(Stack, {\n          alignItems: \"center\",\n          justifyContent: \"flex-start\",\n          direction: \"row\",\n          flexWrap: \"wrap\",\n          width: \"100%\"\n        })\n      })]\n    })\n  });\n}","map":{"version":3,"sources":["/Users/macpro/Desktop/computer-science/projects/laboutiik/mobile/screens/home/Home.tsx"],"names":["React","useRef","Stack","Heading","useMediaQuery","useToast","Layout","Carousel","MainCarouselItem","MainCarouselItemSkeleton","useSWR","formatUrl","getImageUrl","getLogoUrl","useStore","maxSmallScreenWidth","SearchBar","ProductCard","ProductCardSkeleton","CategoryCard","CategoryCardSkeleton","IconCard","ConditionalSuspense","MapList","Home","navigation","route","toast","categories","state","configs","renderGalleryUrl","itemId","currentGallery","length","image","screenData","fetch","res","json","resJson","errors","undefined","show","title","message","gottenServices","data","filter","galleryItem","group","gottenSlides","gottenBrands","services","slides","brands","revalidateOnFocus","shouldRetryOnError","nowToSeeProducts","Error","categoriesProducts","category","push","id","name","products","maxWidth","isSmallScreen","menus","text","icon","screenWidth","Dimensions","get","width","mainCarouselRef","prev","next","item","slideId","findIndex","currentItem","current","description","height","menu","alert","uri","Array","keys","key"],"mappings":"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","sourcesContent":["import React, { useRef } from \"react\";\nimport { Stack, Heading, useMediaQuery, useToast } from \"native-base\";\n\nimport Layout from \"../../components/layout/Layout\";\nimport Carousel from \"react-native-reanimated-carousel\";\nimport { ComponentWithNavigationProps } from \"../../@types/component\";\nimport { Dimensions } from \"react-native\";\nimport MainCarouselItem, {\n  MainCarouselItemSkeleton,\n} from \"../../components/custom/MainCarouselItem\";\nimport useSWR from \"swr\";\nimport { formatUrl, getImageUrl, getLogoUrl } from \"../../helpers/utils\";\nimport { Gallery } from \"../../@types/gallery\";\nimport useStore from \"../../context/store\";\nimport { maxSmallScreenWidth } from \"../../constants/layout\";\nimport SearchBar from \"../../components/custom/SearchBar\";\nimport { Product } from \"../../@types/product\";\nimport ProductCard, {\n  ProductCardSkeleton,\n} from \"../../components/custom/ProductCard\";\nimport CategoryCard, {\n  CategoryCardSkeleton,\n} from \"../../components/custom/CategoryCard\";\nimport IconCard from \"../../components/custom/IconCard\";\nimport { ConditionalSuspense } from \"../../components/layout/ConditionalSuspense\";\nimport { MapList } from \"../../components/layout/MapList\";\nimport ImageCard from \"../../components/custom/ImageCard\";\n\nexport default function Home({\n  navigation,\n  route,\n}: ComponentWithNavigationProps) {\n  const toast = useToast();\n  type ScreenData = {\n    services: Gallery[];\n    slides: Gallery[];\n    brands: Gallery[];\n  };\n\n  const categories = useStore((state) => state.configs.categories);\n\n  const renderGalleryUrl = (itemId, currentGallery) =>\n    currentGallery.length - 1 > itemId\n      ? getImageUrl(`${currentGallery[itemId].image}`)\n      : getLogoUrl();\n\n  const screenData = useSWR<ScreenData>(\n    formatUrl(\n      \"items/gallery?limit=-1&filter[status]=published&sort=-date_created\"\n    ),\n    async (...args: Parameters<typeof fetch>) => {\n      const res = await fetch(...args);\n      const resJson = await res.json();\n      if (resJson.errors != undefined)\n        return toast.show({ title: resJson.errors[0].message });\n\n      const gottenServices = (resJson.data as Gallery[]).filter(\n        (galleryItem: Gallery) => galleryItem.group == \"service\"\n      );\n\n      const gottenSlides = (resJson.data as Gallery[]).filter(\n        (galleryItem: Gallery) => galleryItem.group == \"slider\"\n      );\n\n      const gottenBrands = (resJson.data as Gallery[]).filter(\n        (galleryItem: Gallery) => galleryItem.group == \"brand\"\n      );\n\n      return {\n        services: gottenServices,\n        slides: gottenSlides,\n        brands: gottenBrands,\n      };\n    },\n    { revalidateOnFocus: false, shouldRetryOnError: true }\n  );\n\n  const nowToSeeProducts = useSWR<Product[]>(\n    formatUrl(\n      \"items/products?limit=20&filter[status]=published&sort=-date_created\"\n    ),\n    async (...args: Parameters<typeof fetch>) => {\n      const res = await fetch(...args);\n      const resJson = await res.json();\n      if (resJson.errors != undefined) {\n        toast.show({ title: resJson.errors[0].message });\n        throw new Error(resJson.errors);\n      }\n\n      return resJson.data;\n    },\n    { revalidateOnFocus: false, shouldRetryOnError: true }\n  );\n  type CategoryMap = {\n    id: string;\n    name: string;\n    products: Product[];\n  };\n\n  const categoriesProducts = useSWR<CategoryMap[]>(\n    formatUrl(\n      \"items/products?limit=10&filter[status]=published&sort=-date_created\"\n    ),\n    async (...args: Parameters<typeof fetch>) => {\n      const data: CategoryMap[] = [];\n      for (const category of categories) {\n        const res = await fetch(`${args[0]}&filter[category]=${category}`);\n        const resJson = await res.json();\n        if (resJson.errors != undefined) throw new Error(resJson.errors);\n        if (resJson.data.length != 0) {\n          data.push({\n            id: category.id,\n            name: category.name,\n            products: resJson.data as Product[],\n          });\n        }\n      }\n\n      return data;\n    },\n    { revalidateOnFocus: false, shouldRetryOnError: true }\n  );\n\n  const [isSmallScreen] = useMediaQuery({ maxWidth: maxSmallScreenWidth });\n\n  const menus = [\n    {\n      text: \"Soldes\",\n      route: \"Home\",\n      icon: \"52a7196b-eea7-4e0f-9aa6-99eee1145ce5\",\n    },\n    {\n      text: \"Boutiques\",\n      route: \"Home\",\n      icon: \"fa4014a2-9e42-49d2-b6d6-8aa102ea7beb\",\n    },\n    {\n      text: \"Made in CI\",\n      route: \"Home\",\n      icon: \"ec3ce20b-1145-4e6d-b98c-ae0a897c5785\",\n    },\n    {\n      text: \"Recommandés\",\n      route: \"Home\",\n      icon: \"f2c80949-cae7-4295-a10e-486273147030?\",\n    },\n  ];\n\n  const screenWidth =\n    Dimensions.get(\"window\").width > 1184\n      ? 1184\n      : Dimensions.get(\"window\").width;\n\n  const mainCarouselRef = useRef<any>({\n    prev: () => {},\n    next: () => {},\n  });\n\n  return (\n    <Layout navigation={navigation} route={route}>\n      <>\n        <ConditionalSuspense condition={isSmallScreen}>\n          <SearchBar navigation={navigation} route={route} />\n        </ConditionalSuspense>\n\n        <ConditionalSuspense\n          condition={screenData.data != undefined}\n          fallBack={<MainCarouselItemSkeleton />}\n        >\n          <Carousel\n            width={screenWidth}\n            height={isSmallScreen ? 300 : 500}\n            data={screenData.data?.slides}\n            autoPlay={true}\n            autoPlayInterval={3000}\n            // ref={mainCarouselRef}\n            renderItem={({ item }) => {\n              const slideId = screenData.data?.slides.findIndex(\n                (currentItem: Gallery) => item.id == currentItem.id\n              );\n              return (\n                <MainCarouselItem\n                  onPressPrev={\n                    typeof mainCarouselRef.current.prev == \"function\"\n                      ? mainCarouselRef.current.prev\n                      : () => {}\n                  }\n                  onPressNext={\n                    typeof mainCarouselRef.current.next == \"function\"\n                      ? mainCarouselRef.current.next\n                      : () => {}\n                  }\n                  id={slideId}\n                  totalItem={screenData.data.slides.length}\n                  heading={item.name}\n                  imageUri={renderGalleryUrl(slideId, screenData.data.slides)}\n                  content={item.description}\n                  btnText=\"VOIR PLUS\"\n                  paddingBottom={2}\n                  width=\"100%\"\n                  height={isSmallScreen ? 300 : 500}\n                  imageBackgroundStyle={!isSmallScreen ? {} : { height: 300 }}\n                  containerStyle={!isSmallScreen ? {} : { height: 300 }}\n                  btnAction={() => {}}\n                />\n              );\n            }}\n          />\n        </ConditionalSuspense>\n\n        <Stack\n          display={\"flex\"}\n          alignItems={\"center\"}\n          justifyContent={\"space-around\"}\n          flexDirection={\"row\"}\n          paddingTop={2}\n          width=\"100%\"\n        >\n          <MapList\n            data={menus}\n            render={(menu) => (\n              <IconCard\n                key={menu.text}\n                onPress={() => alert(menu.text)}\n                text={menu.text}\n                image={{ uri: getImageUrl(menu.icon) }}\n              />\n            )}\n          />\n        </Stack>\n\n        <Stack display={\"flex\"} alignItems={\"center\"}>\n          <Heading margin={5}> SÉLECTION RAPIDE</Heading>\n          <Stack\n            alignItems={\"center\"}\n            justifyContent={\"flex-start\"}\n            direction={\"row\"}\n            flexWrap={\"wrap\"}\n          >\n            <ConditionalSuspense\n              condition={categories.length != 0}\n              fallBack={\n                <MapList\n                  data={[...Array(8).keys()]}\n                  render={(key) => <CategoryCardSkeleton key={key} />}\n                />\n              }\n            >\n              <MapList\n                data={categories}\n                render={(item) => (\n                  <CategoryCard\n                    key={item.id}\n                    category={item}\n                    navigation={navigation}\n                  />\n                )}\n              />\n            </ConditionalSuspense>\n          </Stack>\n        </Stack>\n\n        <Stack flex={1} alignItems={\"center\"} width={\"100%\"} height={'auto'}>\n          <Heading margin={5}> ACHÈTE DÈS MAINTENANT</Heading>\n          <Stack\n            alignItems={\"center\"}\n            justifyContent={\"flex-start\"}\n            direction={\"row\"}\n            flexWrap={\"wrap\"}\n            width={\"100%\"}\n          >\n            <ConditionalSuspense\n              condition={nowToSeeProducts.data != undefined}\n              fallBack={\n                <MapList\n                  data={[...Array(8).keys()]}\n                  render={(key) => <ProductCardSkeleton key={key} />}\n                />\n              }\n            >\n              <MapList\n                data={nowToSeeProducts.data}\n                render={(item: Product) => (\n                  <ProductCard key={item.id} product={item} />\n                )}\n              />\n            </ConditionalSuspense>\n          </Stack>\n        </Stack>\n\n\n        <Stack\n          flex={1}\n          alignItems={\"center\"}\n          width={\"100%\"}\n          height={'auto'}\n          backgroundColor=\"#000\"\n        >\n          {/* <Heading margin={5}> LES MEILLEURS MARQUES</Heading> */}\n          <Stack\n            alignItems={\"center\"}\n            justifyContent={\"flex-start\"}\n            direction={\"row\"}\n            flexWrap={\"wrap\"}\n            width={\"100%\"}\n          >\n            {/* <Stack\n              alignItems={\"center\"}\n              justifyContent={\"flex-start\"}\n              direction={\"row\"}\n              flexWrap={\"wrap\"}\n              width={\"100%\"}\n            >\n              <ConditionalSuspense condition={screenData.data ? true : false}>\n                <MapList\n                  data={screenData.data?.brands}\n                  render={(item: Gallery) => (\n                    <ImageCard\n                      key={item.id}\n                      image={{ uri: getImageUrl(item.image) }}\n                      text={item.name}\n                      onPress={() => navigation.navigate(\"Category\")}\n                    />\n                  )}\n                />\n              </ConditionalSuspense>\n            </Stack> */}\n          </Stack>\n        </Stack>\n      </>\n    </Layout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}