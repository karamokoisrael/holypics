{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useRef } from \"react\";\nimport { ScrollView, Stack, Heading, useMediaQuery, useToast } from \"native-base\";\nimport Layout from \"../../components/layouts/Layout\";\nimport Carousel from \"react-native-reanimated-carousel\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport MainCarouselItem, { MainCarouselItemSkeleton } from \"../../components/custom/MainCarouselItem\";\nimport useSWR from \"swr\";\nimport { formatUrl, getImageUrl, getLogoUrl } from \"../../helpers/utils\";\nimport useStore from \"../../context/store\";\nimport { maxSmallScreenWidth } from \"../../constants/layout\";\nimport SearchBar from \"../../components/custom/SearchBar\";\nimport { ProductCardSkeleton } from \"../../components/custom/ProductCard\";\nimport CategoryCard, { CategoryCardSkeleton } from \"../../components/custom/CategoryCard\";\nimport IconCard from \"../../components/custom/IconCard\";\nimport { ConditionalSuspense } from \"../../components/layouts/ConditionalSuspense\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function Home(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var toast = useToast();\n  var categories = useStore(function (state) {\n    return state.configs.categories;\n  });\n\n  var renderGalleryUrl = function renderGalleryUrl(itemId, currentGallery) {\n    return currentGallery.length - 1 > itemId ? getImageUrl(\"\" + currentGallery[itemId].image) : getLogoUrl();\n  };\n\n  var _useSWR = useSWR(formatUrl(\"items/gallery?limit=-1&status=published&sort=-date_created\"), function _callee() {\n    var res,\n        resJson,\n        gottenServices,\n        gottenSlides,\n        _args = arguments;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(fetch.apply(void 0, _args));\n\n          case 3:\n            res = _context.sent;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 6:\n            resJson = _context.sent;\n\n            if (!(resJson.errors != undefined)) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt(\"return\", toast.show({\n              title: resJson.errors[0].message\n            }));\n\n          case 9:\n            gottenServices = resJson.data.filter(function (galleryItem) {\n              return galleryItem.group == \"service\";\n            });\n            gottenSlides = resJson.data.filter(function (galleryItem) {\n              return galleryItem.group == \"slider\";\n            });\n            return _context.abrupt(\"return\", {\n              services: gottenServices,\n              slides: gottenSlides\n            });\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(_context.t0);\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 14]], Promise);\n  }),\n      data = _useSWR.data,\n      error = _useSWR.error;\n\n  var nowToSeeProducts = useSWR(formatUrl(\"items/products?limit=10&status=published&sort=-date_created\"), function _callee2() {\n    var res,\n        resJson,\n        _args2 = arguments;\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(fetch.apply(void 0, _args2));\n\n          case 3:\n            res = _context2.sent;\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(res.json());\n\n          case 6:\n            resJson = _context2.sent;\n\n            if (!(resJson.errors != undefined)) {\n              _context2.next = 10;\n              break;\n            }\n\n            toast.show({\n              title: resJson.errors[0].message\n            });\n            throw new Error(resJson.errors);\n\n          case 10:\n            console.log(resJson);\n            return _context2.abrupt(\"return\", resJson.data);\n\n          case 14:\n            _context2.prev = 14;\n            _context2.t0 = _context2[\"catch\"](0);\n            throw new Error('Handled error');\n\n          case 17:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 14]], Promise);\n  });\n\n  var _useMediaQuery = useMediaQuery({\n    maxWidth: maxSmallScreenWidth\n  }),\n      _useMediaQuery2 = _slicedToArray(_useMediaQuery, 1),\n      isSmallScreen = _useMediaQuery2[0];\n\n  var menus = [{\n    text: \"Soldes\",\n    route: \"Home\",\n    icon: \"52a7196b-eea7-4e0f-9aa6-99eee1145ce5\"\n  }, {\n    text: \"Boutiques\",\n    route: \"Home\",\n    icon: \"fa4014a2-9e42-49d2-b6d6-8aa102ea7beb\"\n  }, {\n    text: \"Made in CI\",\n    route: \"Home\",\n    icon: \"ec3ce20b-1145-4e6d-b98c-ae0a897c5785\"\n  }, {\n    text: \"RecommandÃ©s\",\n    route: \"Home\",\n    icon: \"f2c80949-cae7-4295-a10e-486273147030?\"\n  }];\n  var screenWidth = Dimensions.get(\"window\").width > 1184 ? 1184 : Dimensions.get(\"window\").width;\n  var mainCarouselRef = useRef({\n    prev: function prev() {},\n    next: function next() {}\n  });\n  return _jsx(Layout, {\n    navigation: navigation,\n    route: route,\n    children: _jsx(ScrollView, {\n      flex: 1,\n      height: \"100%\",\n      width: \"100%\",\n      children: _jsxs(_Fragment, {\n        children: [isSmallScreen ? _jsx(SearchBar, {\n          navigation: navigation,\n          route: route\n        }) : null, data ? _jsx(Carousel, {\n          width: screenWidth,\n          height: isSmallScreen ? 300 : 500,\n          data: data.slides,\n          autoPlay: true,\n          autoPlayInterval: 3000,\n          renderItem: function renderItem(_ref2) {\n            var item = _ref2.item;\n            var slideId = data.slides.findIndex(function (currentItem) {\n              return item.id == currentItem.id;\n            });\n            return _jsx(MainCarouselItem, {\n              onPressPrev: typeof mainCarouselRef.current.prev == \"function\" ? mainCarouselRef.current.prev : function () {},\n              onPressNext: typeof mainCarouselRef.current.next == \"function\" ? mainCarouselRef.current.next : function () {},\n              id: slideId,\n              totalItem: data.slides.length,\n              heading: item.name,\n              imageUri: renderGalleryUrl(slideId, data.slides),\n              content: item.description,\n              btnText: \"VOIR PLUS\",\n              paddingBottom: 2,\n              width: \"100%\",\n              height: isSmallScreen ? 300 : 500,\n              imageBackgroundStyle: !isSmallScreen ? {} : {\n                height: 300\n              },\n              containerStyle: !isSmallScreen ? {} : {\n                height: 300\n              },\n              btnAction: function btnAction() {}\n            });\n          }\n        }) : _jsx(MainCarouselItemSkeleton, {}), _jsx(Stack, {\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"space-around\",\n          flexDirection: \"row\",\n          paddingTop: 2,\n          width: \"100%\",\n          children: menus.map(function (menu) {\n            return _jsx(IconCard, {\n              isSmallScreen: isSmallScreen,\n              onPress: function onPress() {\n                return alert(menu.text);\n              },\n              text: menu.text,\n              image: {\n                uri: getImageUrl(menu.icon)\n              }\n            }, menu.text);\n          })\n        }), _jsxs(Stack, {\n          display: \"flex\",\n          alignItems: \"center\",\n          children: [_jsx(Heading, {\n            margin: 5,\n            children: \" S\\xC9LECTION RAPIDE\"\n          }), _jsxs(Stack, {\n            alignItems: \"center\",\n            justifyContent: \"flex-start\",\n            direction: \"row\",\n            flexWrap: \"wrap\",\n            children: [categories.length == 0 ? _toConsumableArray(Array(8).keys()).map(function (key) {\n              return _jsx(CategoryCardSkeleton, {\n                isSmallScreen: isSmallScreen\n              }, key);\n            }) : null, categories.map(function (item) {\n              return _jsx(CategoryCard, {\n                category: item,\n                isSmallScreen: isSmallScreen,\n                navigation: navigation\n              }, item.id);\n            })]\n          })]\n        }), _jsxs(Stack, {\n          flex: 1,\n          alignItems: \"center\",\n          width: \"100%\",\n          height: \"auto\",\n          children: [_jsx(Heading, {\n            margin: 5,\n            children: \" ACH\\xC8TE D\\xC8S MAINTENANT\"\n          }), _jsx(Stack, {\n            alignItems: \"center\",\n            justifyContent: \"flex-start\",\n            direction: \"row\",\n            flexWrap: \"wrap\",\n            width: \"100%\",\n            children: _jsx(ConditionalSuspense, {\n              condition: nowToSeeProducts.data != undefined,\n              fallBack: _jsx(_Fragment, {\n                children: _toConsumableArray(Array(8).keys()).map(function (key) {\n                  return _jsx(ProductCardSkeleton, {\n                    isSmallScreen: isSmallScreen\n                  }, key);\n                })\n              }),\n              children: _jsx(_Fragment, {})\n            })\n          })]\n        })]\n      })\n    })\n  });\n}","map":{"version":3,"sources":["/Users/macpro/Desktop/computer-science/projects/laboutiik/mobile/screens/home/Home.tsx"],"names":["React","useRef","ScrollView","Stack","Heading","useMediaQuery","useToast","Layout","Carousel","MainCarouselItem","MainCarouselItemSkeleton","useSWR","formatUrl","getImageUrl","getLogoUrl","useStore","maxSmallScreenWidth","SearchBar","ProductCardSkeleton","CategoryCard","CategoryCardSkeleton","IconCard","ConditionalSuspense","Home","navigation","route","toast","categories","state","configs","renderGalleryUrl","itemId","currentGallery","length","image","fetch","res","json","resJson","errors","undefined","show","title","message","gottenServices","data","filter","galleryItem","group","gottenSlides","services","slides","console","log","error","nowToSeeProducts","Error","maxWidth","isSmallScreen","menus","text","icon","screenWidth","Dimensions","get","width","mainCarouselRef","prev","next","item","slideId","findIndex","currentItem","id","current","name","description","height","map","menu","alert","uri","Array","keys","key"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport {\n  ScrollView,\n  Stack,\n  Heading,\n  useMediaQuery,\n  useToast,\n} from \"native-base\";\n\nimport Layout from \"../../components/layouts/Layout\";\nimport Carousel from \"react-native-reanimated-carousel\";\nimport { ComponentWithNavigationProps } from \"../../@types/component\";\nimport { Dimensions } from \"react-native\";\nimport MainCarouselItem, {\n  MainCarouselItemSkeleton,\n} from \"../../components/custom/MainCarouselItem\";\nimport useSWR, { SWRResponse } from \"swr\";\nimport { formatUrl, getImageUrl, getLogoUrl } from \"../../helpers/utils\";\nimport { Gallery } from \"../../@types/gallery\";\nimport useStore from \"../../context/store\";\nimport { maxSmallScreenWidth } from \"../../constants/layout\";\nimport SearchBar from \"../../components/custom/SearchBar\";\nimport { Product } from \"../../@types/product\";\nimport ProductCard, {\n  ProductCardSkeleton,\n} from \"../../components/custom/ProductCard\";\nimport CategoryCard, {\n  CategoryCardSkeleton,\n} from \"../../components/custom/CategoryCard\";\nimport IconCard from \"../../components/custom/IconCard\";\nimport { ConditionalSuspense } from \"../../components/layouts/ConditionalSuspense\";\n\nexport default function Home({\n  navigation,\n  route,\n}: ComponentWithNavigationProps) {\n  const toast = useToast();\n  type ScreenData = {\n    services: Gallery[];\n    slides: Gallery[];\n  };\n\n\n  const categories = useStore(state => state.configs.categories)\n\n  const renderGalleryUrl = (itemId, currentGallery) =>\n    currentGallery.length - 1 > itemId\n      ? getImageUrl(`${currentGallery[itemId].image}`)\n      : getLogoUrl();\n\n\n  const { data, error } = useSWR<ScreenData>(\n    formatUrl(\"items/gallery?limit=-1&status=published&sort=-date_created\"),\n    async (...args: Parameters<typeof fetch>) => {\n      try {\n        const res = await fetch(...args);\n        const resJson = await res.json();\n        if (resJson.errors != undefined)\n          return toast.show({ title: resJson.errors[0].message });\n\n        const gottenServices = (resJson.data as Gallery[]).filter(\n          (galleryItem: Gallery) => galleryItem.group == \"service\"\n        );\n\n        const gottenSlides = (resJson.data as Gallery[]).filter(\n          (galleryItem: Gallery) => galleryItem.group == \"slider\"\n        );\n        \n        return {\n          services: gottenServices,\n          slides: gottenSlides,\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  );\n\n  const nowToSeeProducts = useSWR<Product[]>(\n    formatUrl(\"items/products?limit=10&status=published&sort=-date_created\"),\n    async (...args: Parameters<typeof fetch>) => {\n      try {\n        const res = await fetch(...args);\n        const resJson = await res.json();\n        if (resJson.errors != undefined){\n          toast.show({ title: resJson.errors[0].message });\n          throw new Error(resJson.errors)\n        } \n\n        console.log(resJson);\n        \n        return resJson.data;\n      } catch (error) {\n        throw new Error('Handled error')\n      }\n    }\n  );\n\n  const [isSmallScreen] = useMediaQuery({ maxWidth: maxSmallScreenWidth });\n\n  const menus = [\n    {\n      text: \"Soldes\",\n      route: \"Home\",\n      icon: \"52a7196b-eea7-4e0f-9aa6-99eee1145ce5\",\n    },\n    {\n      text: \"Boutiques\",\n      route: \"Home\",\n      icon: \"fa4014a2-9e42-49d2-b6d6-8aa102ea7beb\",\n    },\n    {\n      text: \"Made in CI\",\n      route: \"Home\",\n      icon: \"ec3ce20b-1145-4e6d-b98c-ae0a897c5785\",\n    },\n    {\n      text: \"RecommandÃ©s\",\n      route: \"Home\",\n      icon: \"f2c80949-cae7-4295-a10e-486273147030?\",\n    },\n  ];\n\n  const screenWidth =\n    Dimensions.get(\"window\").width > 1184\n      ? 1184\n      : Dimensions.get(\"window\").width;\n\n  const mainCarouselRef = useRef<any>({\n    prev: () => {},\n    next: () => {},\n  });\n\n  return (\n    <Layout navigation={navigation} route={route}>\n      <ScrollView flex={1} height={\"100%\"} width={\"100%\"}>\n        <>\n          {isSmallScreen ? (\n            <SearchBar navigation={navigation} route={route} />\n          ) : null}\n\n          {data ? (\n            <Carousel\n              width={screenWidth}\n              height={isSmallScreen ? 300 : 500}\n              data={data.slides}\n              autoPlay={true}\n              autoPlayInterval={3000}\n              // ref={mainCarouselRef}\n              renderItem={({ item }) => {\n                const slideId = data.slides.findIndex(\n                  (currentItem: Gallery) => item.id == currentItem.id\n                );\n                return (\n                  <MainCarouselItem\n                    onPressPrev={\n                      typeof mainCarouselRef.current.prev == \"function\"\n                        ? mainCarouselRef.current.prev\n                        : () => {}\n                    }\n                    onPressNext={\n                      typeof mainCarouselRef.current.next == \"function\"\n                        ? mainCarouselRef.current.next\n                        : () => {}\n                    }\n                    id={slideId}\n                    totalItem={data.slides.length}\n                    heading={item.name}\n                    imageUri={renderGalleryUrl(slideId, data.slides)}\n                    content={item.description}\n                    btnText=\"VOIR PLUS\"\n                    paddingBottom={2}\n                    width=\"100%\"\n                    height={isSmallScreen ? 300 : 500}\n                    imageBackgroundStyle={!isSmallScreen ? {} : { height: 300 }}\n                    containerStyle={!isSmallScreen ? {} : { height: 300 }}\n                    btnAction={() => {}}\n                  />\n                );\n              }}\n            />\n          ) : (\n            <MainCarouselItemSkeleton />\n          )}\n\n          <Stack\n            display={\"flex\"}\n            alignItems={\"center\"}\n            justifyContent={\"space-around\"}\n            flexDirection={\"row\"}\n            paddingTop={2}\n            width={\"100%\"}\n          >\n            {menus.map((menu) => {\n              return (\n                <IconCard\n                  key={menu.text}\n                  isSmallScreen={isSmallScreen}\n                  onPress={() => alert(menu.text)}\n                  text={menu.text}\n                  image={{ uri: getImageUrl(menu.icon) }}\n                />\n              );\n            })}\n          </Stack>\n\n          <Stack\n            // paddingTop={5}\n            display={\"flex\"}\n            alignItems={\"center\"}\n            // alignItems={\"center\"}\n            // width={\"100%\"}\n          >\n            <Heading margin={5}> SÃLECTION RAPIDE</Heading>\n\n            <Stack\n              alignItems={\"center\"}\n              justifyContent={\"flex-start\"}\n              direction={\"row\"}\n              flexWrap={\"wrap\"}\n            >\n              {categories.length == 0\n                ? [...Array(8).keys()].map((key) => (\n                    <CategoryCardSkeleton\n                      isSmallScreen={isSmallScreen}\n                      key={key}\n                    />\n                  ))\n                : null}\n              {categories.map((item) => (\n                <CategoryCard\n                  key={item.id}\n                  category={item}\n                  isSmallScreen={isSmallScreen}\n                  navigation={navigation}\n                />\n              ))}\n            </Stack>\n          </Stack>\n\n          <Stack flex={1} alignItems={\"center\"} width={\"100%\"} height={\"auto\"}>\n            <Heading margin={5}> ACHÃTE DÃS MAINTENANT</Heading>\n            <Stack\n              alignItems={\"center\"}\n              justifyContent={\"flex-start\"}\n              direction={\"row\"}\n              flexWrap={\"wrap\"}\n              width={\"100%\"}\n            >\n              <ConditionalSuspense \n                condition={nowToSeeProducts.data != undefined }\n                fallBack={\n                  <>\n                   {[...Array(8).keys()].map((key) => (\n                    <ProductCardSkeleton\n                      isSmallScreen={isSmallScreen}\n                      key={key}\n                    />\n                  ))}\n                  </>\n                }\n                >\n                <>\n                  {/* {nowToSeeProducts.data.map((item: Product) => (\n                    <ProductCard\n                      key={item.id}\n                      isSmallScreen={isSmallScreen}\n                      product={item}\n                    />\n                  ))} */}\n                </>\n              </ConditionalSuspense>\n            </Stack>\n          </Stack>\n        </>\n      </ScrollView>\n    </Layout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}