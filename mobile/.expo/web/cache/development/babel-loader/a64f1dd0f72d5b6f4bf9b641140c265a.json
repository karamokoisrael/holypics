{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactNativeReanimated = _interopRequireWildcard(require(\"react-native-reanimated\"));\n\nvar _useCarouselController = require(\"./hooks/useCarouselController\");\n\nvar _useAutoPlay2 = require(\"./hooks/useAutoPlay\");\n\nvar _usePropsErrorBoundary = require(\"./hooks/usePropsErrorBoundary\");\n\nvar _ScrollViewGesture = require(\"./ScrollViewGesture\");\n\nvar _useVisibleRanges = require(\"./hooks/useVisibleRanges\");\n\nvar _reactNative = require(\"react-native-web/dist/index\");\n\nvar _constants = require(\"./constants\");\n\nvar _BaseLayout = require(\"./layouts/BaseLayout\");\n\nvar _useLayoutConfig = require(\"./hooks/useLayoutConfig\");\n\nvar _useInitProps = require(\"./hooks/useInitProps\");\n\nvar _store = require(\"./store\");\n\nvar _useCommonVariables = require(\"./hooks/useCommonVariables\");\n\nvar _useOnProgressChange = require(\"./hooks/useOnProgressChange\");\n\nvar _this = this,\n    _jsxFileName = \"/Users/zhaodonghao/code/react-native-reanimated-carousel/src/Carousel.tsx\";\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      (0, _defineProperty2.default)(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nvar Carousel = _react.default.forwardRef(function (_props, ref) {\n  var props = (0, _useInitProps.useInitProps)(_props);\n  var data = props.data,\n      rawData = props.rawData,\n      loop = props.loop,\n      mode = props.mode,\n      style = props.style,\n      width = props.width,\n      height = props.height,\n      vertical = props.vertical,\n      autoPlay = props.autoPlay,\n      windowSize = props.windowSize,\n      autoPlayReverse = props.autoPlayReverse,\n      autoPlayInterval = props.autoPlayInterval,\n      scrollAnimationDuration = props.scrollAnimationDuration,\n      withAnimation = props.withAnimation,\n      renderItem = props.renderItem,\n      onScrollEnd = props.onScrollEnd,\n      onSnapToItem = props.onSnapToItem,\n      _onScrollBegin = props.onScrollBegin,\n      onProgressChange = props.onProgressChange,\n      customAnimation = props.customAnimation,\n      defaultIndex = props.defaultIndex;\n  var commonVariables = (0, _useCommonVariables.useCommonVariables)(props);\n  var size = commonVariables.size,\n      handlerOffsetX = commonVariables.handlerOffsetX;\n  var dataLength = data.length;\n  var offsetX = (0, _reactNativeReanimated.useDerivedValue)(function () {\n    var _f = function _f() {\n      var totalSize = size * dataLength;\n      var x = handlerOffsetX.value % totalSize;\n\n      if (!loop) {\n        return handlerOffsetX.value;\n      }\n\n      return isNaN(x) ? 0 : x;\n    };\n\n    _f._closure = {\n      size: size,\n      dataLength: dataLength,\n      handlerOffsetX: handlerOffsetX,\n      loop: loop\n    };\n    _f.asString = \"function _f(){const{size,dataLength,handlerOffsetX,loop}=jsThis._closure;{const totalSize=size*dataLength;const x=handlerOffsetX.value%totalSize;if(!loop){return handlerOffsetX.value;}return isNaN(x)?0:x;}}\";\n    _f.__workletHash = 17456063948631;\n    _f.__location = \"/Users/zhaodonghao/code/react-native-reanimated-carousel/src/Carousel.tsx (52:40)\";\n\n    global.__reanimatedWorkletInit(_f);\n\n    return _f;\n  }(), [loop, size, dataLength]);\n  (0, _usePropsErrorBoundary.usePropsErrorBoundary)(props);\n  (0, _useOnProgressChange.useOnProgressChange)({\n    size: size,\n    offsetX: offsetX,\n    rawData: rawData,\n    onProgressChange: onProgressChange\n  });\n  var carouselController = (0, _useCarouselController.useCarouselController)({\n    loop: loop,\n    size: size,\n    handlerOffsetX: handlerOffsetX,\n    length: data.length,\n    disable: !data.length,\n    withAnimation: withAnimation,\n    originalLength: data.length,\n    defaultIndex: defaultIndex,\n    onScrollEnd: function onScrollEnd() {\n      return (0, _reactNativeReanimated.runOnJS)(_onScrollEnd)();\n    },\n    onScrollBegin: function onScrollBegin() {\n      return !!_onScrollBegin && (0, _reactNativeReanimated.runOnJS)(_onScrollBegin)();\n    },\n    onChange: function onChange(i) {\n      return !!onSnapToItem && (0, _reactNativeReanimated.runOnJS)(onSnapToItem)(i);\n    },\n    duration: scrollAnimationDuration\n  });\n  var next = carouselController.next,\n      prev = carouselController.prev,\n      sharedPreIndex = carouselController.sharedPreIndex,\n      sharedIndex = carouselController.sharedIndex,\n      computedIndex = carouselController.computedIndex,\n      getCurrentIndex = carouselController.getCurrentIndex;\n\n  var _useAutoPlay = (0, _useAutoPlay2.useAutoPlay)({\n    autoPlay: autoPlay,\n    autoPlayInterval: autoPlayInterval,\n    autoPlayReverse: autoPlayReverse,\n    carouselController: carouselController\n  }),\n      start = _useAutoPlay.start,\n      pause = _useAutoPlay.pause;\n\n  var _onScrollEnd = _react.default.useCallback(function () {\n    computedIndex();\n    onScrollEnd == null ? void 0 : onScrollEnd(sharedPreIndex.current, sharedIndex.current);\n  }, [sharedPreIndex, sharedIndex, computedIndex, onScrollEnd]);\n\n  var scrollViewGestureOnScrollBegin = _react.default.useCallback(function () {\n    pause();\n    _onScrollBegin == null ? void 0 : _onScrollBegin();\n  }, [_onScrollBegin, pause]);\n\n  var scrollViewGestureOnScrollEnd = _react.default.useCallback(function () {\n    start();\n\n    _onScrollEnd();\n  }, [_onScrollEnd, start]);\n\n  var scrollViewGestureOnTouchBegin = _react.default.useCallback(pause, [pause]);\n\n  var scrollViewGestureOnTouchEnd = _react.default.useCallback(start, [start]);\n\n  var goToIndex = _react.default.useCallback(function (i, animated) {\n    carouselController.to(i, animated);\n  }, [carouselController]);\n\n  _react.default.useImperativeHandle(ref, function () {\n    return {\n      next: next,\n      prev: prev,\n      getCurrentIndex: getCurrentIndex,\n      goToIndex: goToIndex,\n      scrollTo: carouselController.scrollTo\n    };\n  }, [getCurrentIndex, goToIndex, next, prev, carouselController.scrollTo]);\n\n  var visibleRanges = (0, _useVisibleRanges.useVisibleRanges)({\n    total: data.length,\n    viewSize: size,\n    translation: handlerOffsetX,\n    windowSize: windowSize\n  });\n  var layoutConfig = (0, _useLayoutConfig.useLayoutConfig)(_objectSpread(_objectSpread({}, props), {}, {\n    size: size\n  }));\n\n  var renderLayout = _react.default.useCallback(function (item, i) {\n    var realIndex = i;\n\n    if (rawData.length === _constants.DATA_LENGTH.SINGLE_ITEM) {\n      realIndex = i % 1;\n    }\n\n    if (rawData.length === _constants.DATA_LENGTH.DOUBLE_ITEM) {\n      realIndex = i % 2;\n    }\n\n    return _react.default.createElement(_BaseLayout.BaseLayout, {\n      key: i,\n      index: i,\n      handlerOffsetX: offsetX,\n      visibleRanges: visibleRanges,\n      animationStyle: customAnimation || layoutConfig,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 21\n      }\n    }, function (_ref) {\n      var animationValue = _ref.animationValue;\n      return renderItem({\n        item: item,\n        index: realIndex,\n        animationValue: animationValue\n      });\n    });\n  }, [rawData, offsetX, visibleRanges, renderItem, layoutConfig, customAnimation]);\n\n  return _react.default.createElement(_store.CTX.Provider, {\n    value: {\n      props: props,\n      common: commonVariables\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }, _react.default.createElement(_reactNative.View, {\n    style: [styles.container, {\n      width: width || '100%',\n      height: height || '100%'\n    }, style],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 17\n    }\n  }, _react.default.createElement(_ScrollViewGesture.ScrollViewGesture, {\n    size: size,\n    translation: handlerOffsetX,\n    onScrollBegin: scrollViewGestureOnScrollBegin,\n    onScrollEnd: scrollViewGestureOnScrollEnd,\n    onTouchBegin: scrollViewGestureOnTouchBegin,\n    onTouchEnd: scrollViewGestureOnTouchEnd,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 21\n    }\n  }, _react.default.createElement(_reactNativeReanimated.default.View, {\n    key: mode,\n    style: [styles.container, {\n      width: width || '100%',\n      height: height || '100%'\n    }, style, vertical ? styles.itemsVertical : styles.itemsHorizontal],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 25\n    }\n  }, data.map(renderLayout)))));\n});\n\nvar _default = Carousel;\nexports.default = _default;\n\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    overflow: 'hidden'\n  },\n  itemsHorizontal: {\n    flexDirection: 'row'\n  },\n  itemsVertical: {\n    flexDirection: 'column'\n  }\n});","map":{"version":3,"sources":["Carousel.tsx"],"names":["size","dataLength","loop","handlerOffsetX","Carousel","React","props","data","rawData","mode","style","width","height","vertical","autoPlay","windowSize","autoPlayReverse","autoPlayInterval","scrollAnimationDuration","withAnimation","renderItem","onScrollEnd","onSnapToItem","onScrollBegin","onProgressChange","customAnimation","defaultIndex","commonVariables","offsetX","totalSize","x","isNaN","carouselController","length","disable","originalLength","onChange","duration","next","prev","sharedPreIndex","sharedIndex","computedIndex","getCurrentIndex","start","pause","_onScrollEnd","scrollViewGestureOnScrollBegin","scrollViewGestureOnScrollEnd","scrollViewGestureOnTouchBegin","scrollViewGestureOnTouchEnd","goToIndex","scrollTo","visibleRanges","total","viewSize","translation","layoutConfig","renderLayout","realIndex","DATA_LENGTH","i","animationValue","item","index","common","styles","StyleSheet","container","overflow","itemsHorizontal","flexDirection","itemsVertical"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Animated, { runOnJS, useDerivedValue } from 'react-native-reanimated';\n\nimport { useCarouselController } from './hooks/useCarouselController';\nimport { useAutoPlay } from './hooks/useAutoPlay';\nimport { usePropsErrorBoundary } from './hooks/usePropsErrorBoundary';\nimport { ScrollViewGesture } from './ScrollViewGesture';\nimport { useVisibleRanges } from './hooks/useVisibleRanges';\n\nimport type { ICarouselInstance, TCarouselProps } from './types';\nimport { StyleSheet, View } from 'react-native';\nimport { DATA_LENGTH } from './constants';\nimport { BaseLayout } from './layouts/BaseLayout';\nimport { useLayoutConfig } from './hooks/useLayoutConfig';\nimport { useInitProps } from './hooks/useInitProps';\nimport { CTX } from './store';\nimport { useCommonVariables } from './hooks/useCommonVariables';\nimport { useOnProgressChange } from './hooks/useOnProgressChange';\n\nconst Carousel = React.forwardRef<ICarouselInstance, TCarouselProps<any>>(\n    (_props, ref) => {\n        const props = useInitProps(_props);\n\n        const {\n            data,\n            rawData,\n            loop,\n            mode,\n            style,\n            width,\n            height,\n            vertical,\n            autoPlay,\n            windowSize,\n            autoPlayReverse,\n            autoPlayInterval,\n            scrollAnimationDuration,\n            withAnimation,\n            renderItem,\n            onScrollEnd,\n            onSnapToItem,\n            onScrollBegin,\n            onProgressChange,\n            customAnimation,\n            defaultIndex,\n        } = props;\n\n        const commonVariables = useCommonVariables(props);\n        const { size, handlerOffsetX } = commonVariables;\n        const dataLength = data.length;\n\n        const offsetX = useDerivedValue(() => {\n            const totalSize = size * dataLength;\n            const x = handlerOffsetX.value % totalSize;\n\n            if (!loop) {\n                return handlerOffsetX.value;\n            }\n            return isNaN(x) ? 0 : x;\n        }, [loop, size, dataLength]);\n\n        usePropsErrorBoundary(props);\n        useOnProgressChange({ size, offsetX, rawData, onProgressChange });\n\n        const carouselController = useCarouselController({\n            loop,\n            size,\n            handlerOffsetX,\n            length: data.length,\n            disable: !data.length,\n            withAnimation,\n            originalLength: data.length,\n            defaultIndex,\n            onScrollEnd: () => runOnJS(_onScrollEnd)(),\n            onScrollBegin: () => !!onScrollBegin && runOnJS(onScrollBegin)(),\n            onChange: (i) => !!onSnapToItem && runOnJS(onSnapToItem)(i),\n            duration: scrollAnimationDuration,\n        });\n\n        const {\n            next,\n            prev,\n            sharedPreIndex,\n            sharedIndex,\n            computedIndex,\n            getCurrentIndex,\n        } = carouselController;\n\n        const { start, pause } = useAutoPlay({\n            autoPlay,\n            autoPlayInterval,\n            autoPlayReverse,\n            carouselController,\n        });\n\n        const _onScrollEnd = React.useCallback(() => {\n            computedIndex();\n            onScrollEnd?.(sharedPreIndex.current, sharedIndex.current);\n        }, [sharedPreIndex, sharedIndex, computedIndex, onScrollEnd]);\n\n        const scrollViewGestureOnScrollBegin = React.useCallback(() => {\n            pause();\n            onScrollBegin?.();\n        }, [onScrollBegin, pause]);\n\n        const scrollViewGestureOnScrollEnd = React.useCallback(() => {\n            start();\n            _onScrollEnd();\n        }, [_onScrollEnd, start]);\n\n        const scrollViewGestureOnTouchBegin = React.useCallback(pause, [pause]);\n\n        const scrollViewGestureOnTouchEnd = React.useCallback(start, [start]);\n\n        const goToIndex = React.useCallback(\n            (i: number, animated?: boolean) => {\n                carouselController.to(i, animated);\n            },\n            [carouselController]\n        );\n\n        React.useImperativeHandle(\n            ref,\n            () => ({\n                next,\n                prev,\n                getCurrentIndex,\n                goToIndex,\n                scrollTo: carouselController.scrollTo,\n            }),\n            [\n                getCurrentIndex,\n                goToIndex,\n                next,\n                prev,\n                carouselController.scrollTo,\n            ]\n        );\n\n        const visibleRanges = useVisibleRanges({\n            total: data.length,\n            viewSize: size,\n            translation: handlerOffsetX,\n            windowSize,\n        });\n\n        const layoutConfig = useLayoutConfig({ ...props, size });\n\n        const renderLayout = React.useCallback(\n            (item: any, i: number) => {\n                let realIndex = i;\n                if (rawData.length === DATA_LENGTH.SINGLE_ITEM) {\n                    realIndex = i % 1;\n                }\n\n                if (rawData.length === DATA_LENGTH.DOUBLE_ITEM) {\n                    realIndex = i % 2;\n                }\n\n                return (\n                    <BaseLayout\n                        key={i}\n                        index={i}\n                        handlerOffsetX={offsetX}\n                        visibleRanges={visibleRanges}\n                        animationStyle={customAnimation || layoutConfig}\n                    >\n                        {({ animationValue }) =>\n                            renderItem({\n                                item,\n                                index: realIndex,\n                                animationValue,\n                            })\n                        }\n                    </BaseLayout>\n                );\n            },\n            [\n                rawData,\n                offsetX,\n                visibleRanges,\n                renderItem,\n                layoutConfig,\n                customAnimation,\n            ]\n        );\n\n        return (\n            <CTX.Provider value={{ props, common: commonVariables }}>\n                <View\n                    style={[\n                        styles.container,\n                        { width: width || '100%', height: height || '100%' },\n                        style,\n                    ]}\n                >\n                    <ScrollViewGesture\n                        size={size}\n                        translation={handlerOffsetX}\n                        onScrollBegin={scrollViewGestureOnScrollBegin}\n                        onScrollEnd={scrollViewGestureOnScrollEnd}\n                        onTouchBegin={scrollViewGestureOnTouchBegin}\n                        onTouchEnd={scrollViewGestureOnTouchEnd}\n                    >\n                        <Animated.View\n                            key={mode}\n                            style={[\n                                styles.container,\n                                {\n                                    width: width || '100%',\n                                    height: height || '100%',\n                                },\n                                style,\n                                vertical\n                                    ? styles.itemsVertical\n                                    : styles.itemsHorizontal,\n                            ]}\n                        >\n                            {data.map(renderLayout)}\n                        </Animated.View>\n                    </ScrollViewGesture>\n                </View>\n            </CTX.Provider>\n        );\n    }\n);\n\nexport default Carousel as <T extends any>(\n    props: React.PropsWithChildren<TCarouselProps<T>>\n) => React.ReactElement;\n\nconst styles = StyleSheet.create({\n    container: {\n        overflow: 'hidden',\n    },\n    itemsHorizontal: {\n        flexDirection: 'row',\n    },\n    itemsVertical: {\n        flexDirection: 'column',\n    },\n});\n"]},"metadata":{},"sourceType":"script"}