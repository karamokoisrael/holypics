import{defineComponent as e,ref as t,inject as r,computed as n,resolveComponent as a,openBlock as o,createElementBlock as i,createBlock as l,withCtx as s,resolveDynamicComponent as d,createVNode as u,normalizeClass as c,createCommentVNode as v,createTextVNode as h,toDisplayString as f}from"vue";import{useI18n as p}from"vue-i18n";var g=(0).constructor,m=g.isFinite;g.isInteger;var y=[].constructor.isArray;function b(e){return null!==e&&"object"==typeof e}function w(e,t){return void 0===t&&(t=0),"string"==typeof e&&e.length>=t}function x(e){return m(e)}function E(e){return y(e)}function k(e,t){return b(e)&&t in e}var A=new(function(){function e(e){this.size=e,this.reset()}return e.prototype.reset=function(){this.oldestIndex=0,this.map={},this.cachedKeys=new Array(this.size)},e.prototype.get=function(e){return this.map[e]},e.prototype.set=function(e,t){this.map[e]=t;var r=this.cachedKeys[this.oldestIndex];void 0!==r&&delete this.map[r],this.cachedKeys[this.oldestIndex]=e,this.oldestIndex++,this.oldestIndex%=this.size},e}())(1e3);function _(e){var t=e.charAt(0),r=e.substr(-1);if("'\"`".includes(t)||"'\"`".includes(r)){if(e.length<2||t!==r)throw new SyntaxError('Mismatching string quotation: "'+e+'"');return e.substring(1,e.length-1)}if(e.includes("["))throw new SyntaxError('Missing ] in varName "'+e+'"');return"+"===t?e.substr(1):e}function T(e,t,r){var n=t.trim();if(""===n)return e;if(n.startsWith(".")){if(!r)throw new SyntaxError('Unexpected . at the start of "'+t+'"');if(""===(n=n.substr(1).trim()))return e}else if(r)throw new SyntaxError('Missing . at the start of "'+t+'"');if(n.endsWith("."))throw new SyntaxError('Unexpected "." at the end of "'+t+'"');for(var a=0,o=n.split(".");a<o.length;a++){var i=o[a].trim();if(""===i)throw new SyntaxError('Empty prop name when parsing "'+t+'"');e.push(i)}return e}function S(e){if(!w(e))throw new TypeError("Cannot parse path. Expected string. Got a "+typeof e);for(var t,r,n=0,a=!1,o=new Array(0),i=0;i<e.length&&-1!==(t=e.indexOf("[",i));i=n){if(-1===(n=e.indexOf("]",t)))throw new SyntaxError('Missing ] in varName "'+e+'"');if(0===(r=e.substring(t+1,n).trim()).length)throw new SyntaxError("Unexpected token ]");n++,T(o,e.substring(i,t),a),o.push(_(r)),a=!0}return T(o,e.substring(n),a)}function I(e,t,r){if(void 0===r&&(r={}),!b(r))throw new TypeError("get expects an object option. Got "+typeof r);var n=r.depth,a=void 0===n?10:n;if(!x(a)||a<=0)throw new RangeError("Expected a positive number for depth. Got "+a);var o=Array.isArray(t)?t:S.cached(t),i=function(){return o.join(" > ")};if(o.length>a)throw new ReferenceError("The path cannot be deeper than "+a+' levels. Got "'+i()+'"');for(var l=e,s=0,d=o;s<d.length;s++){var u=d[s];if(!k(l,u)){if(r.propsExist)throw new ReferenceError(u+' is not defined in the scope at path: "'+i()+'"');return}l=l[u]}return l}S.cached=function(e){var t=A.get(e);return void 0===t&&(t=S(e),A.set(e,t)),t};var N=function(){function e(e,t){var r=this;if(void 0===t&&(t={}),this.tokens=e,this.options=t,this.render=function(e){void 0===e&&(e={});var t=r.tokens.varNames.length;r.cacheParsedPaths();for(var n=new Array(t),a=0;a<t;a++)n[a]=I(e,r.toPathCache[a],r.options);return r.stringify(n)},this.renderFn=function(e,t){void 0===t&&(t={});var n=r.resolveVarNames(e,t);return r.stringify(n)},this.renderFnAsync=function(e,t){return void 0===t&&(t={}),Promise.all(r.resolveVarNames(e,t)).then((function(e){return r.stringify(e)}))},!b(e)||!E(e.strings)||!E(e.varNames)||e.strings.length!==e.varNames.length+1)throw new TypeError("Invalid tokens object");if(!b(t))throw new TypeError("Options should be an object. Got a "+typeof t);t.validateVarNames&&this.cacheParsedPaths()}return e.prototype.cacheParsedPaths=function(){var e=this.tokens.varNames;if(void 0===this.toPathCache){this.toPathCache=new Array(e.length);for(var t=0;t<e.length;t++)this.toPathCache[t]=S.cached(e[t])}},e.prototype.resolveVarNames=function(e,t){void 0===t&&(t={});var r=this.tokens.varNames;if("function"!=typeof e)throw new TypeError("Expected a resolver function. Got "+String(e));for(var n=r.length,a=new Array(n),o=0;o<n;o++)a[o]=e.call(null,r[o],t);return a},e.prototype.stringify=function(e){for(var t=this.tokens.strings,r=this.options.explicit,n=e.length,a="",o=0;o<n;o++){a+=t[o];var i=e[o];(r||null!=i)&&(a+=i)}return a+=t[n]},e}();function V(e,t){void 0===t&&(t={});var r=function(e,t){if(void 0===t&&(t={}),!w(e))throw new TypeError("The template parameter must be a string. Got a "+typeof e);if(!b(t))throw new TypeError("Options should be an object. Got a "+typeof t);var r=t.tags,n=void 0===r?["{{","}}"]:r,a=t.maxVarNameLength,o=void 0===a?1e3:a;if(!E(n)||2!==n.length)throw TypeError("tags should be an array of two elements. Got "+String(n));var i=n[0],l=n[1];if(!w(i,1)||!w(l,1)||i===l)throw new TypeError('The open and close symbols should be two distinct non-empty strings. Got "'+i+'" and "'+l+'"');if(!x(o)||o<=0)throw new Error("Expected a positive number for maxVarNameLength. Got "+o);for(var s,d,u=i.length,c=l.length,v=0,h=[],f=[],p=0;p<e.length&&-1!==(s=e.indexOf(i,p));){var g=s+u;if(-1===(v=e.substr(g,o+c).indexOf(l)))throw new SyntaxError('Missing "'+l+'" in the template for the "'+i+'" at position '+s+" within "+o+" characters");if(v+=g,0===(d=e.substring(g,v).trim()).length)throw new SyntaxError('Unexpected "'+l+'" tag found at position '+s);if(d.includes(i))throw new SyntaxError('Variable names cannot have "'+i+'". But at position '+s+'. Got "'+d+'"');f.push(d),v+=c,h.push(e.substring(p,s)),p=v}return h.push(e.substring(v)),{strings:h,varNames:f}}(e,t);return new N(r,t)}var C=e({name:"InterfaceGroupDetail",props:{field:{type:Object,required:!0},fields:{type:Array,required:!0},values:{type:Object,required:!0},initialValues:{type:Object,required:!0},disabled:{type:Boolean,default:!1},batchMode:{type:Boolean,default:!1},batchActiveFields:{type:Array,default:()=>[]},primaryKey:{type:[Number,String],required:!0},loading:{type:Boolean,default:!1},validationErrors:{type:Array,default:()=>[]},layout:{type:String,default:"modal"},title:{type:String,default:null},headerIcon:{type:String,default:null},headerColor:{type:String,default:"secondary"}},emits:["apply"],setup(e){const{t:a}=p(),o=t(!1),i=r("values",t({}));return{t:a,groupTitle:n((()=>{return e.title?(t=e.title,r=i.value,V(t,n).render(r)):e.field.name;var t,r,n})),internalActive:o}}});const $={class:"group-modal"};var G=[],j=[];!function(e,t){if(e&&"undefined"!=typeof document){var r,n=!0===t.prepend?"prepend":"append",a=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(a){var i=G.indexOf(o);-1===i&&(i=G.push(o)-1,j[i]={}),r=j[i]&&j[i][n]?j[i][n]:j[i][n]=l()}else r=l();65279===e.charCodeAt(0)&&(e=e.substring(1)),r.styleSheet?r.styleSheet.cssText+=e:r.appendChild(document.createTextNode(e))}function l(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var r=Object.keys(t.attributes),a=0;a<r.length;a++)e.setAttribute(r[a],t.attributes[r[a]]);var i="prepend"===n?"afterbegin":"beforeend";return o.insertAdjacentElement(i,e),e}}("\n.trigger-button.info[data-v-64969d30] {\n\t--v-button-background-color: var(--blue);\n\t--v-button-background-color-hover: var(--blue-125);\n\t--v-button-color: var(--blue-alt);\n\t--v-button-color-hover: var(--blue-alt);\n}\n.trigger-button.success[data-v-64969d30] {\n\t--v-button-background-color: var(--success);\n\t--v-button-background-color-hover: var(--success-125);\n\t--v-button-color: var(--success-alt);\n\t--v-button-color-hover: var(--success-alt);\n}\n.trigger-button.warning[data-v-64969d30] {\n\t--v-button-background-color: var(--warning);\n\t--v-button-background-color-hover: var(--warning-125);\n\t--v-button-color: var(--warning-alt);\n\t--v-button-color-hover: var(--warning-alt);\n}\n.trigger-button.danger[data-v-64969d30] {\n\t--v-button-icon-color: var(--white);\n\t--v-button-background-color: var(--danger);\n\t--v-button-background-color-hover: var(--danger-125);\n\t--v-button-color: var(--danger-alt);\n\t--v-button-color-hover: var(--danger-alt);\n}\n.v-form[data-v-64969d30] {\n\tpadding-top: calc(var(--form-vertical-gap) / 2);\n}\n.v-form.in-drawer[data-v-64969d30] {\n\tpadding-left: var(--form-horizontal-gap);\n}\n@media (max-width: 959px) {\n.v-form.in-drawer[data-v-64969d30] {\n\t\tpadding-right: var(--form-horizontal-gap);\n}\n}\n",{}),C.render=function(e,t,r,n,p,g){const m=a("v-icon"),y=a("v-button"),b=a("v-card-title"),w=a("v-form"),x=a("v-card-text"),E=a("v-card-actions"),k=a("v-card"),A=a("v-dialog"),_=a("v-drawer");return o(),i("div",$,["modal"===e.layout?(o(),l(A,{key:0,modelValue:e.internalActive,"onUpdate:modelValue":t[2]||(t[2]=t=>e.internalActive=t),onEsc:t[3]||(t[3]=t=>e.internalActive=!1),persistent:!0,placement:"center"},{activator:s((({on:t})=>[(o(),l(d(e.validationErrors.length>0?"v-badge":"div"),{icon:"priority_high",bordered:""},{default:s((()=>[u(y,{small:"",class:c(["trigger-button",e.headerColor]),onClick:t},{default:s((()=>[e.headerIcon?(o(),l(m,{key:0,name:e.headerIcon,left:"",disabled:e.disabled},null,8,["name","disabled"])):v("v-if",!0),h(" "+f(e.groupTitle),1)])),_:2},1032,["class","onClick"])])),_:2},1024))])),default:s((()=>[u(k,null,{default:s((()=>[u(b,null,{default:s((()=>[e.headerIcon?(o(),l(m,{key:0,name:e.headerIcon,left:"",disabled:e.disabled},null,8,["name","disabled"])):v("v-if",!0),h(" "+f(e.groupTitle),1)])),_:1}),u(x,null,{default:s((()=>[u(w,{"initial-values":e.initialValues,fields:e.fields,"model-value":e.values,"primary-key":e.primaryKey,group:e.field.meta.field,"validation-errors":e.validationErrors,loading:e.loading,"batch-mode":e.batchMode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("apply",t))},null,8,["initial-values","fields","model-value","primary-key","group","validation-errors","loading","batch-mode"])])),_:1}),u(E,null,{default:s((()=>[u(y,{onClick:t[1]||(t[1]=t=>e.internalActive=!1)},{default:s((()=>[h(f(e.t("done")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])):(o(),l(_,{key:1,modelValue:e.internalActive,"onUpdate:modelValue":t[5]||(t[5]=t=>e.internalActive=t),persistent:!0,title:e.groupTitle,icon:e.headerIcon||"box",onCancel:t[6]||(t[6]=t=>e.internalActive=!1)},{activator:s((({on:t})=>[(o(),l(d(e.validationErrors.length>0?"v-badge":"div"),{icon:"priority_high",bordered:""},{default:s((()=>[u(y,{small:"",class:c(["trigger-button",e.headerColor]),onClick:t},{default:s((()=>[e.headerIcon?(o(),l(m,{key:0,name:e.headerIcon,left:"",disabled:e.disabled},null,8,["name","disabled"])):v("v-if",!0),h(" "+f(e.groupTitle),1)])),_:2},1032,["class","onClick"])])),_:2},1024))])),default:s((()=>[u(w,{"initial-values":e.initialValues,fields:e.fields,"model-value":e.values,"primary-key":e.primaryKey,group:e.field.meta.field,"validation-errors":e.validationErrors,loading:e.loading,"batch-mode":e.batchMode,class:"in-drawer","onUpdate:modelValue":t[4]||(t[4]=t=>e.$emit("apply",t))},null,8,["initial-values","fields","model-value","primary-key","group","validation-errors","loading","batch-mode"])])),_:1},8,["modelValue","title","icon"]))])},C.__scopeId="data-v-64969d30",C.__file="src/interface.vue";var O={id:"extension-group-modal",name:"$t:interfaces.user.modes.modal",description:"Group fields into modal dialog, accessible from a button",icon:"web_asset",component:C,hideLabel:!0,hideLoader:!0,types:["alias"],localTypes:["group"],group:"group",options:e=>[{field:"layout",name:"$t:layout_setup",type:"string",meta:{width:"half",interface:"select-dropdown",default_value:"modal",options:{choices:[{text:"$t:interfaces.user.modes.modal",value:"modal"},{text:"$t:sidebar",value:"sidebar"}]}},schema:{default_value:"modal"}},{field:"title",type:"string",name:"$t:title",meta:{width:"full",interface:"system-display-template",required:!0,options:{collectionName:e.collection,font:"monospace",placeholder:"$t:interfaces.boolean.label_placeholder"}}},{field:"headerIcon",name:"$t:interfaces.group-detail.header_icon",type:"string",meta:{interface:"select-icon",width:"half"}},{field:"headerColor",name:"$t:interfaces.group-detail.header_color",type:"string",meta:{width:"half",interface:"select-dropdown",default_value:"",options:{choices:[{text:"$t:primary",value:"primary"},{text:"$t:normal",value:"secondary"},{text:"$t:info",value:"info"},{text:"$t:success",value:"success"},{text:"$t:warning",value:"warning"},{text:"$t:danger",value:"danger"}]}},schema:{default_value:""}}]};export{O as default};
