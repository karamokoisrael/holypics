import{defineModule as t}from"@directus/extensions-sdk";import{defineComponent as e,resolveComponent as a,openBlock as n,createBlock as o,withCtx as c,createElementVNode as i,withDirectives as s,createVNode as r,vShow as l,createElementBlock as u,Fragment as d,renderList as k,toDisplayString as p,createTextVNode as b}from"vue";var h=e({data:()=>({backupList:[]}),async created(){try{const t=await fetch("/db/get-backup-list"),e=await t.json();this.backupList=e}catch(t){}},methods:{async onDelete(t){console.log("deleting => ",t);try{const e=await fetch(`/db/delete-backup/${t}`,{method:"DELETE"});await e.json();this.backupList=this.backupList.filter((e=>e!=t))}catch{}},async onRestore(t){console.log("restoring => ",t);try{const e=await fetch(`/db/db-restore/${t}`,{method:"POST"});await e.json();this.backupList=this.backupList.filter((e=>e!=t)),alert("opÃ©ration en cours"),window.localStorage.clear(),window.location="/"}catch{}},async onSave(){try{const t=await fetch("/cron/db-backup"),e=(await t.json(),await fetch("/db/get-backup-list")),a=await e.json();this.backupList=a}catch{}}}});const f=b("Sauvgarder maintenant"),m=b("Restorer"),w=b("Supprimer");h.render=function(t,e,b,h,g,v){const L=a("v-skeleton-loader"),y=a("v-button"),_=a("v-list-item"),S=a("v-list"),j=a("private-view");return n(),o(j,{title:"Backup manager"},{default:c((()=>[i("div",null,[s(r(L,null,null,512),[[l,0==t.backupList.length]]),r(y,{kind:"success",rounded:"true",onClick:e[0]||(e[0]=e=>t.onSave())},{default:c((()=>[f])),_:1}),(n(!0),u(d,null,k(t.backupList,(e=>(n(),o(S,{key:e,class:"backup-container"},{default:c((()=>[r(_,{class:"backup-item"},{default:c((()=>[i("h5",null,p(e),1),r(y,{kind:"warning",rounded:"true",onClick:a=>t.onRestore(e)},{default:c((()=>[m])),_:2},1032,["onClick"]),r(y,{kind:"danger",rounded:"true",onClick:a=>t.onDelete(e)},{default:c((()=>[w])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])])),_:1})},h.__file="src/module.vue";var g=t({id:"mgx-db-manager",name:"Database Manager",icon:"backup",routes:[{path:"",component:h}]});export{g as default};
